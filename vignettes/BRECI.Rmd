---
title: "BRECI"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{BRECI}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
```

```{r setup}
library(BRECI)
```

# Binned Relative Environmental Change Index (BRECI)

## Background

Ecological niche models (ENMs) are now widely used in conservation and assessment tasks, and in population genetic and evolutionary ecology studies. Alternate terms for these models include Environmental Niche Models, Species Distribution Models (SDMs) and Habitat Suitability Models (HSMs).

A frequent aspect using this class of model is to contrast the nature of suitable environmental conditions at two times (e.g. climate change impacts), or in two locations (e.g. potential impact of invasive species). The outputs from these models are typically raster maps of suitability scores. There are many avenues to compare and contrast the differences between two model output maps but they are often statistical scores which makes it challenging to fully appreciate the nature of differences between times or regions. Single statistical scores also make it difficult to understand the implications difference may have for management decisions, or their influences on population genetic or evolutionary processes.

The purpose of BRECI is to provide a simple but informative graphical representation of differences between two raster maps. This vignette is to demonstrate the use of the functions *BRECIplot()* and *gainLossMaps*, to produce effective graphics to assist in the interpretation of differences between two raster maps.

## Basic requirements

To use *BRECIplot()* the two rasters to be compared _*must*_:

* be loadable into the *R* environment as *rasterLayer* objects from the *R*-package *raster*;
* have the same raster geometry (e.g. same spatial extent and origin, same grid cell size or resolution); and,
* have suitability scores scaled in the same way (e.g. 0 (no suitability) to 1 (maximum suitability)). 

## Types of change

A fundamental question in contrasts between ENM rasters is: Is there a *gain* or *loss* of suitability?

In many examples in the ENM literature this question is answered by making binary maps using a threshold suitability value and measuring the difference in area between the two rasters. There are a a number of methods available to chose a threshold value but a fundamental problem is that, by making a continuously varying suitability scale into a binary one, we loose useful information. For example, we cannot tell if there is a gain or loss of moderately suitable habitat. This could be an important element in determining, for example, an appropriate conservation management response. A BRECI plot provides a compromise solution to this dilemma by showing relative gain or loss across a user-selected set of score ranges (bins).

## Example BRECIplots

Six simple *rasterLayer* objects are available in the *BRECI* package and we will use them to illustrate the basic use of the functions *BRECIplot()* and *gainLossMaps()*.

### Little change:

Maps ras1 and ras2 are and example of two rasters which have only minor differences across all bins.

```{r echo = FALSE}
##op <- par(mfrow = c(1,2), fin = c(7, 3.5))
raster::plot(ras1, main = "ras1")
raster::plot(ras2, main = "ras2")
##par(op)
```

Here is the basic BRECI plot for these two maps:

```{r echo = TRUE}
BRECIplot(ras1, ras2, saveToFile = FALSE)
```

Although there is little change in the *overall* gain/loss in each bin or class, looking at the plots for the two rasters shows that there have been major spatial shifts in the distribution of suitability values. This is a useful insight which could help form more appropriate management responses. 

### Big gains in suitability:

```{r echo = FALSE}
##op <- par(mfrow = c(1,2), fin = c(7, 3.5))
raster::plot(ras3, main = "ras3")
raster::plot(ras4, main = "ras4")
##par(op)
```

```{r echo = TRUE}
BRECIplot(ras3, ras4, saveToFile = FALSE)
```

### Big losses in suitability:

```{r echo = FALSE}
##op <- par(mfrow = c(1,2), fin = c(7, 3.5))
raster::plot(ras5, main = "ras5")
raster::plot(ras6, main = "ras6")
##par(op)
```

```{r echo = TRUE}
BRECIplot(ras5, ras6, saveToFile = FALSE)
```

### Gain/loss maps:

A BRECI plot shows an overall trend in suitability scores between two raster. It is 'aspatial': it does not show *where* on the map transitions have occurred. That could be very important information - perhaps not so for our very small and simple examples, but it becomes a real challenge to make those assessments with out assistance on real-life ENM outputs. The function *gainLossMaps* can provide the needed spatial insights.

```{r }
gainLossMaps(ras3, ras4, saveToFile = FALSE)

```



## Model performance and comparison

**A BRECI plot does not measure or represent model quality or performance.**
